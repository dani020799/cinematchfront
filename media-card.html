<!-- Media Card Template: works both as a dynamically-fetched fragment and as a standalone page -->
<a href="/movie/123" class="group block w-full max-w-[12rem]">
  <div class="relative bg-white/20 backdrop-blur-xl rounded-2xl shadow-2xl hover:shadow-3xl border border-white/30 overflow-hidden transform transition duration-300 hover:scale-[1.05] hover:bg-white/25 p-0">
    <!-- Poster -->
    <div class="relative w-full aspect-[2/3] bg-white/10">
      <img
        src="https://image.tmdb.org/t/p/w500/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg"
        alt="Guardians of the Galaxy Vol. 3 poster"
        class="absolute inset-0 h-full w-full object-cover"
      />
      
      <!-- Bookmark Button -->
      <button 
        onclick="toggleBookmark && toggleBookmark(this); event.preventDefault(); event.stopPropagation();"
        class="absolute top-2 left-2 bg-white/20 hover:bg-blue-500 hover:text-white text-white p-1 rounded-full transition z-10"
        title="Bookmark this movie"
      >
        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
          <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z" />
        </svg>
      </button>
      
      <!-- Rating badge -->
      <div class="absolute top-2 right-2 bg-black/80 backdrop-blur-md text-white text-xs font-semibold px-2 py-1 rounded-full flex items-center gap-1 border border-white/20">
        <svg class="w-4 h-4 text-orange-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.802 2.036a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.802-2.036a1 1 0 00-1.175 0l-2.802 2.036c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.88 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
        </svg>
        <span>8.2</span>
      </div>
      
      <!-- Hover overlay -->
      <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
    </div>

    <!-- Meta -->
    <div class="p-3">
      <h3 class="text-white font-semibold leading-snug drop-shadow-md">Guardians of the Galaxy Vol. 3</h3>
      <p class="mt-1 text-sm text-orange-100">2023 • Action, Adventure</p>
      
      <!-- My Rating Button -->
      <button 
        onclick="rateMovie && rateMovie('Guardians of the Galaxy Vol. 3'); event.preventDefault(); event.stopPropagation();"
        class="text-blue-400 hover:text-blue-300 text-sm font-semibold flex items-center mt-2 transition"
        title="Rate this movie"
      >
        <svg class="w-4 h-4 mr-1" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.802 2.036a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.802-2.036a1 1 0 00-1.175 0l-2.802 2.036c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.88 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
        </svg>
        My Rating
      </button>
    </div>
  </div>
</a>

<!-- Standalone enhancer: only runs when this file is opened directly in the browser.
     When fetched into index.html, only the <a> card above is inserted and this script is ignored. -->
<script>
(function () {
  // If this card is embedded via fetch/template, there will not be a full document to enhance.
  // Run only when opened directly (best-effort check):
  if (window.top !== window) return; // inside an iframe
  // If the first element on the page is not the card link, it likely isn't our standalone load.
  var card = document.querySelector('a.group');
  if (!card) return;

  // Ensure Tailwind is available. If not, load it dynamically.
  function ensureTailwind(cb) {
    if (window.tailwind) { cb(); return; }
    var s = document.createElement('script');
    s.src = 'https://cdn.tailwindcss.com';
    s.async = true;
    s.onload = cb;
    document.head.appendChild(s);
  }

  function applyBaseStyles() {
    // Add base font and page background similar to index.html
    document.body.classList.add('bg-gradient-to-br','from-orange-400','via-red-500','to-blue-900','min-h-screen','text-white');
    var style = document.createElement('style');
    style.textContent = "body{font-family:'Inter',system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif}";
    document.head.appendChild(style);

    // Build a centered container and place the card inside
    var outer = document.createElement('div');
    outer.className = 'min-h-screen flex items-center justify-center p-8';

    var frame = document.createElement('div');
    frame.className = 'max-w-7xl mx-auto';

    // Insert before altering DOM to keep script execution stable
    document.body.innerHTML = '';
    frame.appendChild(card);
    outer.appendChild(frame);
    document.body.appendChild(outer);

    // Optional title
    document.title = 'Cinematch • Media Card';

    // Fallback handlers so buttons don\'t error when opened standalone
    window.toggleBookmark = window.toggleBookmark || function (el) {
      el.classList.toggle('ring-2');
      el.classList.toggle('ring-blue-400');
    };

    window.rateMovie = window.rateMovie || function (title) {
      // Lightweight integration: fetch the popup and show it
      fetch('rate_popup.html').then(r=>r.text()).then(function (html) {
        var c = document.createElement('div');
        c.innerHTML = html;
        document.body.appendChild(c);
        var titleEl = c.querySelector('#popup-title');
        if (titleEl) titleEl.textContent = 'Rate: ' + title;
      }).catch(console.error);
    };
  }

  ensureTailwind(applyBaseStyles);
})();
</script>